!function(t){t.fn.extend({tableHTMLExport:function(e){var n={separator:",",newline:"\r\n",ignoreColumns:"",ignoreRows:"",type:"csv",htmlContent:!1,consoleLog:!1,trimContent:!0,quoteFields:!0,filename:"tableHTMLExport.csv",utf8BOM:!0,orientation:"p"};function o(t){return n.htmlContent?content_data=t.html().trim():content_data=t.text().trim(),content_data}function i(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function r(n){var i=[];t(n).find("thead").find("tr").not(e.ignoreRows).each(function(){var n=[];t(this).find("th").not(e.ignoreColumns).each(function(e,i){"none"!=t(this).css("display")&&n.push(o(t(this)))}),i.push(n)});var r=[];return t(n).find("tbody").find("tr").not(e.ignoreRows).each(function(){var n=[];t(this).find("td").not(e.ignoreColumns).each(function(e,i){"none"!=t(this).css("display")&&n.push(o(t(this)))}),r.push(n)}),{header:i[0],data:r}}var a;if("csv"==(e=t.extend(n,e)).type||"txt"==e.type){var s=this.filter("table");if(s.length<=0)throw new Error("tableHTMLExport must be called on a <table> element");if(s.length>1)throw new Error("converting multiple table elements at once is not supported yet");a=function(n){var o="";!0===e.utf8BOM&&(o+="\ufeff");var i=n.find("tr").not(e.ignoreRows),r=i.first().find("td,th").not(e.ignoreColumns).length;return i.each(function(){t(this).find("td,th").not(e.ignoreColumns).each(function(n,i){var a=t(i),s=e.trimContent?t.trim(a.text()):a.text();o+=e.quoteFields?'"'+s.replace('"','""')+'"':s,o+=n!==r-1?e.separator:e.newline})}),o}(s),n.consoleLog&&console.log(a),i(e.filename,a)}else if("json"==e.type){var l=r(this);n.consoleLog&&console.log(JSON.stringify(l)),a=JSON.stringify(l),i(e.filename,a)}else if("pdf"==e.type){var c={head:[(l=r(this)).header],body:l.data};n.consoleLog&&console.log(c);var d=new jsPDF(n.orientation,"pt");d.autoTable(c),d.save(e.filename)}return this}})}(jQuery);